{% extends 'partials/base.html.twig' %}

{% block content %}
{# Chargement des données #}
{% include 'partials/skn/flex-loader.html.twig' %}

<div class="skn-page-content">
    {# Header #}
    <header class="skn-page-header">
        <div class="skn-page-header__info">
            <h1><i class="la la-compass"></i> Explorer</h1>
            <p>Découvrez les rooms et les membres</p>
        </div>
        {% if is_logged_in %}
            <a href="/create-room" class="skn-btn skn-btn--primary">
                <i class="la la-plus"></i> Créer
            </a>
        {% endif %}
    </header>
    
    {# Messages flash #}
    {% include 'partials/atoms/flash-messages.html.twig' %}
    
    {# Toutes les rooms #}
    <section class="skn-section">
        <header class="skn-section__header">
            <h2><i class="la la-comments"></i> Toutes les rooms ({{ rooms_count }})</h2>
        </header>

        {% if rooms_count > 0 %}
            <div class="skn-card-grid">
                {% for room in rooms %}
                    {% include 'partials/atoms/room-card.html.twig' with {room: room} %}
                {% endfor %}
            </div>
        {% else %}
            {% include 'partials/atoms/empty-state.html.twig' with {
                icon: 'la-comments',
                title: 'Aucune room',
                message: is_logged_in ? 'Soyez le premier à créer une room !' : 'Inscrivez-vous pour créer des rooms',
                action_url: is_logged_in ? '/create-room' : '/register',
                action_label: is_logged_in ? 'Créer une room' : 'Rejoindre'
            } %}
        {% endif %}
    </section>

    {# Membres #}
    {% if accounts %}
        <section class="skn-section">
            <header class="skn-section__header">
                <h2><i class="la la-users"></i> Membres ({{ users_count }})</h2>
            </header>

            <div class="skn-card-grid skn-card-grid--sm">
                {% for user in accounts %}
                    {% if user.username != 'admin' %}
                        {% include 'partials/atoms/user-card.html.twig' with {user: user} %}
                    {% endif %}
                {% endfor %}
            </div>
        </section>
    {% endif %}
</div>
{% endblock %}
